# Blender to Godot (BTG) Pipeline
A simple JSON-based Blender to Godot pipeline for Godot class and variable assignments from within Blender.

## Installation
* Download the latest BTG release and extract the zip
* Place `btg_entity_importer/` in the `addons/` folder of your Godot project
* In Blender, go to `Edit > Preferences > Add-ons`
  * Select the dropdown on the top right and click "Install from Disk..."
  * Navigate to `btg_entity_exporter.zip` and click "Install from Disk"

## Overview
The pipeline uses two JSON files:
* `entity_template.json`: A file (written by you) that tells Blender what classes and variables you want to expose
* `entity_definition.json`: A file generated by the Blender add-on and used in the importer to assign your Godot classes and variables to your exported `.glb/.gltf` model

The workflow is typically:
* Write `entity_template.json` for your Godot project, updating it as you develop new functionality and want to expose new classes/variables
  * Updates will need to be re-imported into Blender
* Once you're finished in Blender, export your model and hit the `Write BTG import JSON` button
  * Note: exporting your model does not write the `entity_definition.json`, exporting and importing the entity information is a separate process
* In Godot, add the path of `entity_definition.json` to your `.glb/.gltf` model custom import settings and re-import

## Writing the Entity Template JSON
Each entity has a class name and a set of parameters. Each parameter has a type, default, and description.

#### `entity_template.json` Format
```
{
  "ClassNameHere": {
    "var_name_here": ["type", default, "description"],
    "second_var_name_here": ...
  },
  "SecondClassName": {
    ...
  },
  ...
}
```

#### Example `entity_template.json`
```
{
  "CharacterBody3D": {
    "floor_stop_on_slope": ["bool", true, "If true, the body will not slide on slopes when standing still."],
    "max_slides": ["int", 6, "Maximum number of times the body can change direction before it stops when calling move_and_slide."],
    "up_direction": ["Vector3", [0, 1, 0], "Vector pointing upwards, used to determine what is a wall and what is a floor."]
  },
  "Area3D": {
    "angular_damp": ["float", 0.1, "The rate at which objects stop spinning in this area."]
  }
}
```

#### Custom Variable Handling
You can implement custom variable handling by passing in the name of a function as `type` in your entity template. This function must take as string input and return a value.


#### Things to Note
* Every parameter in `entity_template.json` other than `default` is a string.
* `default` represents your Godot variable type. Supported Godot types are:
  * String, ex: `"var_name": ["String", "", "desc"]`
  * int, ex: `"var_name": ["int", 0, "desc"]`
  * bool, ex: `"var_name": ["bool", false, "desc"]`
  * float, ex: `"var_name": ["float", 0.0, "desc"]`
  * Vector3, ex: `"var_name": ["Vector3", [0.0, 0.0, 0.0], "desc"]`
  * Vector3i, ex: `"var_name": ["Vector3i", [0, 0, 0], "desc"]`
  * Vector2, ex: `"var_name": ["Vector2", [0.0, 0.0], "desc"]`
  * Vector2i, ex: `"var_name": ["Vector2i", [0, 0], "desc"]`
* The above values are handled automatically by the importer. To Add new variable types or to handle importing a specific variable yourself, use the name of a member function as `type`
* The Blender extension has a catch-all for unknown entries in the `type` field. If you enter a value that is not one of the above, it will be interpreted as a string.

## BTG Import JSON
Once you have written your `entity_template.json`, imported it into your Blender project, and assigned your classes, you are ready to write the import JSON.

A Generated `entity_definition.json` may look something like:
```
{
    "Cube": {
        "class": "CharacterBody3D",
        "variables": {
            "floor_stop_on_slope": ["bool", false],
            "max_slides": ["int", 19],
            "up_direction": ["Vector3", "(-0.32999998331069946, 1.149999976158142, 0.32999998331069946)"]
        }
    },
    "Icosphere": {
        "class": "Area3D",
        "variables": {
            "angular_damp": ["float", 0.8199999928474426]
        }
    }
}
```
#### Things to Note:
TODO


# TODO
* Finish "BTG Import JSON" section
* add "useful tools" section with links to complimentary addons